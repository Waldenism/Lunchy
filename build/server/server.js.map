{"version":3,"sources":["../../lunchyapp/server/server.js"],"names":["bodyParser","require","cookieParser","DEFAULT_PORT","app","compiler","set","process","env","PORT","Promise","global","connect","passport","session","use","secret","resave","saveUninitialized","initialize","urlencoded","extended","json","routes","NODE_ENV","console","log","webpackMiddleware","webpackHotMiddleware","middleware","publicPath","output","contentBase","stats","colors","hash","timings","chunks","chunkModules","modules","static","join","__dirname","get","request","response","sendFile","listen","error","settings","port"],"mappings":";;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAWA;;;;;;AAVA,IAAMA,aAAaC,QAAQ,aAAR,CAAnB;AACA,IAAMC,eAAeD,QAAQ,eAAR,CAArB;;AAEA,IAAME,eAAe,IAArB;AACA,IAAMC,MAAM,wBAAZ;AACA,IAAMC,WAAW,yCAAjB;AACAD,IAAIE,GAAJ,CAAQ,MAAR,EAAgBC,QAAQC,GAAR,CAAYC,IAAZ,IAAoBN,YAApC;;AAGA;;AAEA,mBAASO,OAAT,GAAmBC,OAAOD,OAA1B;AACA,mBAASE,OAAT,CAAiB,4BAAjB;;AAGA;AACA,IAAIC,WAAWZ,QAAQ,UAAR,CAAf;AACA,IAAIa,UAAUb,QAAQ,iBAAR,CAAd;;AAEAA,QAAQ,uBAAR,EAAiCY,QAAjC;AACAT,IAAIW,GAAJ,CAAQD,QAAQ;AACdE,UAAQ,aADM;AAEdC,UAAQ,KAFM;AAGdC,qBAAmB;AAHL,CAAR,CAAR;AAKAd,IAAIW,GAAJ,CAAQF,SAASM,UAAT,EAAR;AACAf,IAAIW,GAAJ,CAAQF,SAASC,OAAT,EAAR;;AAGAV,IAAIW,GAAJ,CAAQb,cAAR,E,CAAyB;AACzB;AACAE,IAAIW,GAAJ,CAAQf,WAAWoB,UAAX,CAAsB,EAAEC,UAAU,IAAZ,EAAtB,CAAR;AACAjB,IAAIW,GAAJ,CAAQf,WAAWsB,IAAX,EAAR;;AAGA;AACA,IAAMC,SAAStB,QAAQ,qBAAR,CAAf;AACAG,IAAIW,GAAJ,CAAQ,GAAR,EAAaQ,MAAb;;AAGA,IAAGhB,QAAQC,GAAR,CAAYgB,QAAZ,KAAyB,aAA5B,EAA2C;AACzCC,UAAQC,GAAR,CAAY,gCAAZ;;AAEA,MAAMC,oBAAoB1B,QAAQ,wBAAR,CAA1B;AACA,MAAM2B,uBAAuB3B,QAAQ,wBAAR,CAA7B;AACA,MAAM4B,aAAaF,kBAAkBtB,QAAlB,EAA4B;AAC7CyB,gBAAY,kBAAOC,MAAP,CAAcD,UADmB;AAE7CE,iBAAa,QAFgC;AAG7CC,WAAO;AACLC,cAAQ,IADH;AAELC,YAAM,KAFD;AAGLC,eAAS,IAHJ;AAILC,cAAQ,KAJH;AAKLC,oBAAc,KALT;AAMLC,eAAS;AANJ;AAHsC,GAA5B,CAAnB;;AAaAnC,MAAIW,GAAJ,CAAQc,UAAR;AACAzB,MAAIW,GAAJ,CAAQa,qBAAqBvB,QAArB,CAAR;AACD;;AAGDD,IAAIW,GAAJ,CAAQ,kBAAQyB,MAAR,CAAe,eAAKC,IAAL,CAAUC,SAAV,EAAqB,qBAArB,CAAf,CAAR;AACAtC,IAAIuC,GAAJ,CAAQ,GAAR,EAAa,UAASC,OAAT,EAAkBC,QAAlB,EAA2B;AACtCA,WAASC,QAAT,CAAkB,eAAKL,IAAL,CAAUC,YAAY,wBAAtB,EAAgD,YAAhD,CAAlB;AACD,CAFD;;AAMAtC,IAAI2C,MAAJ,CAAW3C,IAAIuC,GAAJ,CAAQ,MAAR,CAAX,EAA4B,UAAUK,KAAV,EAAiB;AACzC,MAAGA,KAAH,EAAU;AACNvB,YAAQC,GAAR,CAAYsB,KAAZ;AACH,GAFD,MAEO;AACH,8CAAyB5C,IAAI6C,QAAJ,CAAaC,IAAtC;AACAzB,YAAQC,GAAR,CAAY,wBAAZ;AACH;AACJ,CAPD","file":"server.js","sourcesContent":["import express from 'express';\nimport path from 'path';\nimport open from 'open';\nimport webpack from 'webpack';\nimport config from './webpack.config';\nconst bodyParser = require('body-parser');\nconst cookieParser = require('cookie-parser');\n\nconst DEFAULT_PORT = 3000;\nconst app = express();\nconst compiler = webpack(config);\napp.set(\"port\", process.env.PORT || DEFAULT_PORT);\n\n\n//mongoose config\nimport mongoose from 'mongoose';\nmongoose.Promise = global.Promise;\nmongoose.connect('mongodb://localhost/lunchy');\n\n\n//passport config\nvar passport = require('passport');\nvar session = require('express-session');\n\nrequire('../config/passport.js')(passport);\napp.use(session({\n  secret: 'mySecretKey',\n  resave: false,\n  saveUninitialized: false\n} ));\napp.use(passport.initialize());\napp.use(passport.session());\n\n\napp.use(cookieParser()); // read cookies (needed for auth)\n// required for passport\napp.use(bodyParser.urlencoded({ extended: true }));\napp.use(bodyParser.json());\n\n\n//route\nconst routes = require('../routes/routes.js');\napp.use('/', routes);\n\n\nif(process.env.NODE_ENV === 'development') {\n  console.log('Running in DEVELOPMENT mode...');\n\n  const webpackMiddleware = require('webpack-dev-middleware');\n  const webpackHotMiddleware = require('webpack-hot-middleware');\n  const middleware = webpackMiddleware(compiler, {\n    publicPath: config.output.publicPath,\n    contentBase: 'public',\n    stats: {\n      colors: true,\n      hash: false,\n      timings: true,\n      chunks: false,\n      chunkModules: false,\n      modules: false,\n    }\n  })\n\n  app.use(middleware)\n  app.use(webpackHotMiddleware(compiler))\n}\n\n\napp.use(express.static(path.join(__dirname, \"../../client/public\")))\napp.get('*', function(request, response){\n  response.sendFile(path.join(__dirname + '../../../client/public', 'index.html'))\n})\n\n\n\napp.listen(app.get(\"port\"), function (error) {\n    if(error) {\n        console.log(error);\n    } else {\n        open(`http://localhost:${app.settings.port}`);\n        console.log('Listening on port 3000');\n    }\n})\n"]}