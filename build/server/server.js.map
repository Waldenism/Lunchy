{"version":3,"sources":["../../lunchyapp/server/server.js"],"names":["bodyParser","require","cookieParser","DEFAULT_PORT","app","compiler","set","process","env","PORT","Promise","global","MONGODB_URI","connect","passport","session","use","secret","resave","saveUninitialized","initialize","urlencoded","extended","json","routes","NODE_ENV","console","log","webpackMiddleware","webpackHotMiddleware","middleware","publicPath","output","contentBase","stats","colors","hash","timings","chunks","chunkModules","modules","static","join","__dirname","get","request","response","sendFile","listen","error"],"mappings":";;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AAYA;;;;;;AAVA,IAAMA,aAAaC,QAAQ,aAAR,CAAnB;AACA,IAAMC,eAAeD,QAAQ,eAAR,CAArB;;AAEA,IAAME,eAAe,IAArB;AACA,IAAMC,MAAM,wBAAZ;AACA,IAAMC,WAAW,yCAAjB;AACAD,IAAIE,GAAJ,CAAQ,MAAR,EAAgBC,QAAQC,GAAR,CAAYC,IAAZ,IAAoBN,YAApC;;AAGA;;AAEA,mBAASO,OAAT,GAAmBC,OAAOD,OAA1B;;AAEA,IAAIE,WAAJ,EAAiB;AACf,qBAASC,OAAT,CAAiB,8FAAjB;AACD,CAFD,MAEO;AACL,qBAASA,OAAT,CAAiB,4BAAjB;AACD;;AAID;AACA,IAAIC,WAAWb,QAAQ,UAAR,CAAf;AACA,IAAIc,UAAUd,QAAQ,iBAAR,CAAd;;AAEAA,QAAQ,uBAAR,EAAiCa,QAAjC;AACAV,IAAIY,GAAJ,CAAQD,QAAQ;AACdE,UAAQ,aADM;AAEdC,UAAQ,KAFM;AAGdC,qBAAmB;AAHL,CAAR,CAAR;AAKAf,IAAIY,GAAJ,CAAQF,SAASM,UAAT,EAAR;AACAhB,IAAIY,GAAJ,CAAQF,SAASC,OAAT,EAAR;;AAGAX,IAAIY,GAAJ,CAAQd,cAAR,E,CAAyB;AACzB;AACAE,IAAIY,GAAJ,CAAQhB,WAAWqB,UAAX,CAAsB,EAAEC,UAAU,IAAZ,EAAtB,CAAR;AACAlB,IAAIY,GAAJ,CAAQhB,WAAWuB,IAAX,EAAR;;AAGA;AACA,IAAMC,SAASvB,QAAQ,qBAAR,CAAf;AACAG,IAAIY,GAAJ,CAAQ,GAAR,EAAaQ,MAAb;;AAGA,IAAGjB,QAAQC,GAAR,CAAYiB,QAAZ,KAAyB,aAA5B,EAA2C;AACzCC,UAAQC,GAAR,CAAY,gCAAZ;;AAEA,MAAMC,oBAAoB3B,QAAQ,wBAAR,CAA1B;AACA,MAAM4B,uBAAuB5B,QAAQ,wBAAR,CAA7B;AACA,MAAM6B,aAAaF,kBAAkBvB,QAAlB,EAA4B;AAC7C0B,gBAAY,kBAAOC,MAAP,CAAcD,UADmB;AAE7CE,iBAAa,QAFgC;AAG7CC,WAAO;AACLC,cAAQ,IADH;AAELC,YAAM,KAFD;AAGLC,eAAS,IAHJ;AAILC,cAAQ,KAJH;AAKLC,oBAAc,KALT;AAMLC,eAAS;AANJ;AAHsC,GAA5B,CAAnB;;AAaApC,MAAIY,GAAJ,CAAQc,UAAR;AACA1B,MAAIY,GAAJ,CAAQa,qBAAqBxB,QAArB,CAAR;AACD;;AAGDD,IAAIY,GAAJ,CAAQ,kBAAQyB,MAAR,CAAe,eAAKC,IAAL,CAAUC,SAAV,EAAqB,qBAArB,CAAf,CAAR;AACAvC,IAAIwC,GAAJ,CAAQ,GAAR,EAAa,UAASC,OAAT,EAAkBC,QAAlB,EAA2B;AACtCA,WAASC,QAAT,CAAkB,eAAKL,IAAL,CAAUC,YAAY,wBAAtB,EAAgD,YAAhD,CAAlB;AACD,CAFD;;AAMAvC,IAAI4C,MAAJ,CAAW5C,IAAIwC,GAAJ,CAAQ,MAAR,CAAX,EAA4B,UAAUK,KAAV,EAAiB;AACzC,MAAGA,KAAH,EAAU;AACNvB,YAAQC,GAAR,CAAYsB,KAAZ;AACH,GAFD,MAEO;AACHvB,YAAQC,GAAR,CAAY,wBAAZ;AACH;AACJ,CAND","file":"server.js","sourcesContent":["import express from 'express';\nimport path from 'path';\nimport webpack from 'webpack';\nimport config from './webpack.config';\n\nconst bodyParser = require('body-parser');\nconst cookieParser = require('cookie-parser');\n\nconst DEFAULT_PORT = 3000;\nconst app = express();\nconst compiler = webpack(config);\napp.set(\"port\", process.env.PORT || DEFAULT_PORT);\n\n\n//mongoose config\nimport mongoose from 'mongoose';\nmongoose.Promise = global.Promise;\n\nif (MONGODB_URI) {\n  mongoose.connect('mongodb://heroku_5cq9xdl6:ni4ii1548pq8k463isc4lg6ll7@ds255347.mlab.com:55347/heroku_5cq9xdl6')\n} else {\n  mongoose.connect('mongodb://localhost/lunchy');\n}\n\n\n\n//passport config\nvar passport = require('passport');\nvar session = require('express-session');\n\nrequire('../config/passport.js')(passport);\napp.use(session({\n  secret: 'mySecretKey',\n  resave: false,\n  saveUninitialized: false\n} ));\napp.use(passport.initialize());\napp.use(passport.session());\n\n\napp.use(cookieParser()); // read cookies (needed for auth)\n// required for passport\napp.use(bodyParser.urlencoded({ extended: true }));\napp.use(bodyParser.json());\n\n\n//route\nconst routes = require('../routes/routes.js');\napp.use('/', routes);\n\n\nif(process.env.NODE_ENV === 'development') {\n  console.log('Running in DEVELOPMENT mode...');\n\n  const webpackMiddleware = require('webpack-dev-middleware');\n  const webpackHotMiddleware = require('webpack-hot-middleware');\n  const middleware = webpackMiddleware(compiler, {\n    publicPath: config.output.publicPath,\n    contentBase: 'public',\n    stats: {\n      colors: true,\n      hash: false,\n      timings: true,\n      chunks: false,\n      chunkModules: false,\n      modules: false,\n    }\n  })\n\n  app.use(middleware)\n  app.use(webpackHotMiddleware(compiler))\n}\n\n\napp.use(express.static(path.join(__dirname, \"../../client/public\")))\napp.get('*', function(request, response){\n  response.sendFile(path.join(__dirname + '../../../client/public', 'index.html'))\n})\n\n\n\napp.listen(app.get(\"port\"), function (error) {\n    if(error) {\n        console.log(error);\n    } else {\n        console.log('Listening on port 3000');\n    }\n})\n"]}