{"version":3,"sources":["../../lunchyapp/middlewares/orders.js"],"names":["Orders","require","Users","Order","newOrder","user","callback","console","log","userid","groupid","theOrder","restaurant","i","addItem","group","item","name","balance","paid","save","err","length","deleteOrder","data","_id","value","remove","id","handleError","getOrders","find","res","module","exports"],"mappings":";;AAAA,IAAIA,SAASC,QAAQ,kBAAR,CAAb;AACA,IAAIC,QAAQD,QAAQ,iBAAR,CAAZ;;AAEA,IAAME,QAAQ;AACVC,cAAU,kBAACC,IAAD,EAAOC,QAAP,EAAoB;AAC1BC,gBAAQC,GAAR,CAAYH,IAAZ;AAD0B,YAEpBI,MAFoB,GAEsBJ,IAFtB,CAEpBI,MAFoB;AAAA,YAEZC,OAFY,GAEsBL,IAFtB,CAEZK,OAFY;AAAA,YAEHC,QAFG,GAEsBN,IAFtB,CAEHM,QAFG;AAAA,YAEOC,UAFP,GAEsBP,IAFtB,CAEOO,UAFP;;;AAI1B,YAAI,CAACH,MAAL,EAAa;AACTF,oBAAQC,GAAR,CAAY,eAAZ;AAEH,SAHD,MAGO;AAAA,uCAEMK,CAFN;AAGC,oBAAIC,UAAU,IAAId,MAAJ,EAAd;AACAc,wBAAQL,MAAR,GAAiBA,MAAjB;AACAK,wBAAQC,KAAR,GAAgBL,OAAhB;AACAI,wBAAQE,IAAR,GAAeL,SAASE,CAAT,EAAYI,IAA3B;AACAH,wBAAQF,UAAR,GAAqBA,UAArB;AACAE,wBAAQI,OAAR,GAAkB,EAAlB;AACAJ,wBAAQK,IAAR,GAAe,KAAf;;AAEA;AACAL,wBAAQM,IAAR,CAAa,UAASC,GAAT,EAAc;AACvB,wBAAIA,GAAJ,EAAQ;AACJd,gCAAQC,GAAR,CAAY,2BAAyBa,GAArC;AACA,8BAAMA,GAAN;AACH;AACDd,4BAAQC,GAAR,CAAY,mCAAZ;AACAD,4BAAQC,GAAR,CAAYM,OAAZ;;AAEA;AACH,iBATD;AAZD;;AAEH,iBAAK,IAAID,IAAE,CAAX,EAAcA,IAAIF,SAASW,MAA3B,EAAmCT,GAAnC,EAAwC;AAAA,sBAA/BA,CAA+B;AAoBvC;AAEJ;AACJ,KAjCS;;AAmCVU,iBAAa,qBAAClB,IAAD,EAAOmB,IAAP,EAAalB,QAAb,EAA0B;;AAEnC,YAAI,CAACD,IAAL,EAAW;AACPE,oBAAQC,GAAR,CAAY,eAAZ;AAEH,SAHD,MAGO;AAAA,gBACGiB,GADH,GACkBpB,IADlB,CACGoB,GADH;AAAA,gBACQV,KADR,GACkBV,IADlB,CACQU,KADR;AAAA,gBAEGW,KAFH,GAEaF,IAFb,CAEGE,KAFH;;;AAIH1B,mBAAO2B,MAAP,CAAc,EAAElB,QAAQgB,GAAV,EAAeV,OAAOA,MAAMa,EAA5B,EAAgCZ,MAAMU,KAAtC,EAAd,EAA4D,UAASL,GAAT,EAAc;AACtE,oBAAIA,GAAJ,EAAS,OAAOQ,YAAYR,GAAZ,CAAP;AACTf;AACH,aAHD;AAIH;AACJ,KAjDS;;AAmDVwB,eAAW,mBAACF,EAAD,EAAKtB,QAAL,EAAkB;AACzBN,eAAO+B,IAAP,CAAY,EAAE,SAASH,EAAX,EAAe,QAAQ,KAAvB,EAAZ,EAA4C,UAASP,GAAT,EAAcW,GAAd,EAAmB;AAC3D,gBAAIX,GAAJ,EAAS;AAAEd,wBAAQC,GAAR,CAAYa,GAAZ;AAAkB;AAC7Bf,qBAAS0B,GAAT;AACH,SAHD;AAIH;AAxDS,CAAd;;AA4DAC,OAAOC,OAAP,GAAiB/B,KAAjB","file":"orders.js","sourcesContent":["var Orders = require('../models/orders');\nvar Users = require('../models/users');\n\nconst Order = {\n    newOrder: (user, callback) => {\n        console.log(user)\n        let { userid, groupid, theOrder, restaurant } = user;\n\n        if (!userid) {\n            console.log('not logged in');\n\n        } else {\n\n            for (let i=0; i < theOrder.length; i++) {\n                let addItem = new Orders()\n                addItem.userid = userid;\n                addItem.group = groupid;\n                addItem.item = theOrder[i].name;\n                addItem.restaurant = restaurant;\n                addItem.balance = 10;\n                addItem.paid = false;\n\n                //save the user\n                addItem.save(function(err) {\n                    if (err){\n                        console.log('Error in Saving item: '+err);\n                        throw err;\n                    }\n                    console.log(\"**** Item added to Database *****\");\n                    console.log(addItem);\n\n                    // callback(addItem);\n                });\n            }\n            \n        }\n    },\n\n    deleteOrder: (user, data, callback) => {\n\n        if (!user) {\n            console.log('not logged in');\n\n        } else {\n            let { _id, group } = user;\n            let { value } = data;\n\n            Orders.remove({ userid: _id, group: group.id, item: value}, function(err) {\n                if (err) return handleError(err);\n                callback();\n            });\n        };\n    },\n\n    getOrders: (id, callback) => {\n        Orders.find({ 'group': id, 'paid': false }, function(err, res) {\n            if (err) { console.log(err) };\n            callback(res)\n        })\n    }\n}\n\n\nmodule.exports = Order;\n"]}