{"version":3,"sources":["../../lunchyapp/middlewares/orders.js"],"names":["Orders","require","Users","Order","newOrder","user","userid","groupid","theOrder","name","console","log","i","addItem","group","item","balance","paid","save","err","length","deleteOrder","data","callback","value","remove","id","handleError","getOrders","find","res","getMyOrders","cb","module","exports"],"mappings":";;AAAA,IAAIA,SAASC,QAAQ,kBAAR,CAAb;AACA,IAAIC,QAAQD,QAAQ,iBAAR,CAAZ;;AAEA,IAAME,QAAQ;AACVC,cAAU,kBAACC,IAAD,EAAU;AAAA,YACVC,MADU,GAC0BD,IAD1B,CACVC,MADU;AAAA,YACFC,OADE,GAC0BF,IAD1B,CACFE,OADE;AAAA,YACOC,QADP,GAC0BH,IAD1B,CACOG,QADP;AAAA,YACiBC,IADjB,GAC0BJ,IAD1B,CACiBI,IADjB;;;AAGhB,YAAI,CAACH,MAAL,EAAa;AACTI,oBAAQC,GAAR,CAAY,eAAZ;AAEH,SAHD,MAGO;AAAA,uCAEMC,CAFN;AAGC,oBAAIC,UAAU,IAAIb,MAAJ,EAAd;AACAa,wBAAQP,MAAR,GAAiBA,MAAjB;AACAO,wBAAQJ,IAAR,GAAeA,IAAf;AACAI,wBAAQC,KAAR,GAAgBP,OAAhB;AACAM,wBAAQE,IAAR,GAAeP,SAASI,CAAT,EAAYH,IAA3B;AACAI,wBAAQG,OAAR,GAAkB,EAAlB;AACAH,wBAAQI,IAAR,GAAe,KAAf;;AAEA;AACAJ,wBAAQK,IAAR,CAAa,UAASC,GAAT,EAAc;AACvB,wBAAIA,GAAJ,EAAQ;AACJT,gCAAQC,GAAR,CAAY,2BAAyBQ,GAArC;AACA,8BAAMA,GAAN;AACH;AACDT,4BAAQC,GAAR,CAAY,mCAAZ;AACAD,4BAAQC,GAAR,CAAYE,OAAZ;AACH,iBAPD;AAZD;;AAEH,iBAAK,IAAID,IAAE,CAAX,EAAcA,IAAIJ,SAASY,MAA3B,EAAmCR,GAAnC,EAAwC;AAAA,sBAA/BA,CAA+B;AAkBvC;AAEJ;AACJ,KA9BS;;AAgCVS,iBAAa,qBAAChB,IAAD,EAAOiB,IAAP,EAAaC,QAAb,EAA0B;;AAEnC,YAAI,CAAClB,IAAL,EAAW;AACPK,oBAAQC,GAAR,CAAY,eAAZ;AAEH,SAHD,MAGO;AAAA,gBACGG,KADH,GACaT,IADb,CACGS,KADH;AAAA,gBAEGU,KAFH,GAEqBF,IAFrB,CAEGE,KAFH;AAAA,gBAEUlB,MAFV,GAEqBgB,IAFrB,CAEUhB,MAFV;;;AAIHN,mBAAOyB,MAAP,CAAc,EAAEnB,QAAQA,MAAV,EAAkBQ,OAAOA,MAAMY,EAA/B,EAAmCX,MAAMS,KAAzC,EAAd,EAA+D,UAASL,GAAT,EAAc;AACzE,oBAAIA,GAAJ,EAAS,OAAOQ,YAAYR,GAAZ,CAAP;AACTI;AACH,aAHD;AAIH;AACJ,KA9CS;;AAgDVK,eAAW,mBAACF,EAAD,EAAKH,QAAL,EAAkB;AACzBvB,eAAO6B,IAAP,CAAY,EAAE,SAASH,EAAX,EAAe,QAAQ,KAAvB,EAAZ,EAA4C,UAASP,GAAT,EAAcW,GAAd,EAAmB;AAC3D,gBAAIX,GAAJ,EAAS;AAAET,wBAAQC,GAAR,CAAYQ,GAAZ;AAAkB;AAC7BI,qBAASO,GAAT;AACH,SAHD;AAIH,KArDS;;AAuDVC,iBAAa,qBAACL,EAAD,EAAKM,EAAL,EAAY;AACrBhC,eAAO6B,IAAP,CAAY,EAAE,UAAUH,EAAZ,EAAZ,EAA8B,UAASP,GAAT,EAAcW,GAAd,EAAmB;AAC7C,gBAAIX,GAAJ,EAAS;AAAET,wBAAQC,GAAR,CAAYQ,GAAZ;AAAkB;AAC7Ba,eAAGF,GAAH;AACH,SAHD;AAIH;AA5DS,CAAd;;AAgEAG,OAAOC,OAAP,GAAiB/B,KAAjB","file":"orders.js","sourcesContent":["var Orders = require('../models/orders');\nvar Users = require('../models/users');\n\nconst Order = {\n    newOrder: (user) => {\n        let { userid, groupid, theOrder, name } = user;\n\n        if (!userid) {\n            console.log('not logged in');\n\n        } else {\n\n            for (let i=0; i < theOrder.length; i++) {\n                let addItem = new Orders()\n                addItem.userid = userid;\n                addItem.name = name;\n                addItem.group = groupid;\n                addItem.item = theOrder[i].name;\n                addItem.balance = 10;\n                addItem.paid = false;\n\n                //save the user\n                addItem.save(function(err) {\n                    if (err){\n                        console.log('Error in Saving item: '+err);\n                        throw err;\n                    }\n                    console.log(\"**** Item added to Database *****\");\n                    console.log(addItem);\n                });\n            }\n\n        }\n    },\n\n    deleteOrder: (user, data, callback) => {\n\n        if (!user) {\n            console.log('not logged in');\n\n        } else {\n            let { group } = user;\n            let { value, userid } = data;\n\n            Orders.remove({ userid: userid, group: group.id, item: value}, function(err) {\n                if (err) return handleError(err);\n                callback();\n            });\n        };\n    },\n\n    getOrders: (id, callback) => {\n        Orders.find({ 'group': id, 'paid': false }, function(err, res) {\n            if (err) { console.log(err) };\n            callback(res)\n        })\n    },\n\n    getMyOrders: (id, cb) => {\n        Orders.find({ 'userid': id }, function(err, res) {\n            if (err) { console.log(err) };\n            cb(res)\n        })\n    }\n}\n\n\nmodule.exports = Order;\n"]}